---
sidebar_position: 1
title: Services Synopsis
---

:::danger Incomplete

This document is not yet updated.

:::

## File Hierarchy

For the lab setup, we'll be using some conventions to organize our configurations. The organization isn't based solely on making things easier for our brains, they are also organized in a way that works well with automation processes that we'll be going over in the next section.

- In short, to setup your directory structure as this document expects, do the following:

  ```sh
  sudo mkdir -p /opt/{managedcfg,state,secure,imports,artifacts}
  sudo mkdir -p /opt/managedcfg/lab
  sudo chown -R $UID /opt/{managedcfg,state,secure,imports,artifacts}
  ```

- Everything I do will be in `/opt`. Historically, I used to do everything in `/work`, but I eventually found that _Mac OS_ doesn't like users creating any old folder in the root (`/`) folder. Therefore, to have a convention that works universally, I now base all of my _system wide_ work in `/opt`.

- `/opt/managedcfg` - This is where all of our service configuration will be kept. All of this configuration **should** eventually be revision controlled (i.e. managed). But to bootstrap ourselves, we'll have to do without until our Gitea (`git`) service is available.

- `/opt/state` - This is where all of the state generated by our services will be created and stored. This can be persistent databases, temporal save states, or default configuration. In the case where there configuration in the state folder that we want to control or manage, it should be captured into revision control (`managedcfg`) and either updated on every rollout or more ideally embedded into the container image.

  Note: We keep `/opt/state` separate from `/opt/managedcfg` because `/opt/state` is the data that needs to be backed up (and possibly snapshot-ed). The container images shouldn't need to be backed up because they already exist in the Gitea repositories and if we do backup the binaries, it'd be part of the `/opt/artifact` backup or `gitea_svc` state backup.

- `/opt/artifacts` - In general, this is for built binaries, images, and other types of output artifacts. Since these should all be things that can be repeatably generated, there backup policy is vastly lower than other backup policies.

- `/opt/secure` - This folder is for audit logs and other things that involve the authentication and authorization of the system.

- `/opt/imports` - This folder is where we can store external read-only copies of files used by our services.

<!-- ## All The Things Without The Words

Planning to make available in `git` or `zip` soon. -->